<head>

</head>
<body>
    <div>
        <img src = "images/Dunban.png" class="Character" id="Dunban" onclick="PurchaseCharacter(this)">
        <p id = "dunbanPoints"> 400 Points</p>
    </div>
    <div>
        <img src = "images/Melia.png" class="Character" id="Melia" onclick="PurchaseCharacter(this)">
        <p id = "meliaPoints"> 200 Points</p>
        
    </div>
    <div>
        <img src = "images/Reyn.png" class="Character" id="Reyn" onclick="PurchaseCharacter(this)">
        <p id = "reynPoints"> 50 Points</p>
    </div>
</div>
<img src="images/Colony9Background.jpg" width="100%"; height = "80%">
<div class="Content">
    <img src="images/mechon1.png" id="Enemy"; onclick="RegisterHit()" width="190%">
</div>
</body>
<script>
    //Reyn attacks
bone_upper = new Sound("sounds/BoneUpper.wav")
shield_bash = new Sound("sounds/ShieldBash.wav")
lariat = new Sound("sounds/Lariat.wav")
ReynMiss = new Sound("sounds/Reyn_miss.wav")

//Dunban Attacks

soaringTempets = new Sound("sounds/Soaring_tempest.wav")
StealStrike = new Sound("sounds/StealStrike.wav")
WorldlySlash = new Sound("sounds/WorldlySlash.wav")
DunbanMiss = new Sound("sounds/Dunban_miss.wav")

//Melia Attacks

Flare = new Sound("sounds/Fire.wav")
Thunder = new Sound("sounds/Thunder.wav")
BurstEnd = new Sound("sounds/BurstEnd.wav")
MeliaMiss = new Sound("sounds/Melia_miss.wav")
function Sound(src){
    this.sound = document.createElement("audio");
    this.sound.src = src;
    this.sound.setAttribute("preload","auto")
    this.sound.setAttribute("Controls", "none")
    this.sound.style.display = "none"
    document.body.appendChild(this.sound)
    this.play = function(){
        this.sound.play();
    }
    this.stop = function(){
        this.sound.pause();
    }
}

function getRandomInt(max){
    return Math.floor(Math.random()*max)
}

function reynMoves(){
    attack = getRandomInt(4);
    switch(attack){
        case(0):
       
        bone_upper.play();
        return 50;
        case(1):
       
        shield_bash.play();
        return 40;
        case(2):
       
        lariat.play();
        return 20;
       
    }
    ReynMiss.play();
    return 0
}
function MeliaMoves(){
    attack = getRandomInt(4);
    switch(attack){
        case(1):
        Flare.play()
        return 120
        //ice move
        case(2):
        Thunder.play()
        return 80
        //Fire move
        case(3):
        BurstEnd.play()
        return 240
        //Lighting move
    }
    MeliaMiss.play();
    return 0;
}
function DunbanMoves(){
    attack = getRandomInt(4);
    switch(attack){
        case(1):
       
        soaringTempets.play();
        return 300
        case(2):
        
        StealStrike.play()
        return 400
        case(3):
        
        WorldlySlash.play();
        return 500

    }
    DunbanMiss.play()
    return 0
}
    var enemy = document.getElementById("Enemy");
    var scoreElement = document.getElementById("Score")
    var reyn = document.getElementById("Reyn")
    var melia = document.getElementById("Melia")
    var dunban = document.getElementById("Dunban")
    var reynPoints = 50;
    var reynPointEle = document.getElementById("reynPoints")
    var meliaPoints = 200;
    var meliaPointEle = document.getElementById("meliaPoints")
    var dunbanPoints = 400;
    var dunbanPointsEle = document.getElementById("dunbanPoints")
    var score = 0;
    var cooldown = 20;
    var Dunban_Bought = false;
    var Melia_Bought = false;
    var Reyn_Bought = false;
    var reynSound = new Sound("sounds/reyn_entrance.wav")
    var dunbanSound = new Sound("sounds/DunbanEntrance.wav")
    var meliaSound = new Sound("sounds/MeliaEntrance.wav")
    var ReynCooldown = 30000
    var MeliaCooldown = 50000
    var DunbanCooldown = 80000
    var backgroundMusic= new Sound("sounds/background.mp3")
    setInterval(DunbanAttack,DunbanCooldown);
    setInterval(MeliaAttack, MeliaCooldown);
    setInterval(ReynAttack, ReynCooldown);
    
    function ReynAttack(){
        if (Reyn_Bought == true){
           
           UpdateScore(reynMoves())
       }

    }
    function MeliaAttack(){
        if(Melia_Bought == true){
           
           UpdateScore(MeliaMoves())
       }

    }
    function DunbanAttack(){
       
        if(Dunban_Bought==true){
            UpdateScore(DunbanMoves())
        }
    } 
    function PurchaseCharacter(chr){
        if(chr.id == "Reyn"){
            if(score>= reynPoints){
                Reyn_Bought = true;
                console.log("bought")
                reynSound.play();
                UpdateScore(reynPoints*-1)
                reynPointEle.innerHTML = "xxx"
            }
            else{
                alert("Not enough points")
            }
        }
        if(chr.id == "Melia"){
            if(score>= meliaPoints){
                Melia_Bought = true;
                UpdateScore(meliaPoints*-1)
                meliaSound.play();
                
                meliaPointEle.innerHTML= "xxx"
            }
            else{
                alert("Not enough points")
            }
        }
        if (chr.id == "Dunban"){
            if(score>= dunbanPoints){
                Dunban_Bought = true;
                dunbanSound.play();
                UpdateScore(dunbanPoints*-1)
                dunbanPointsEle.innerHTML = "xxx" // could replace this with a cooldown timer
            }
            else{
                alert("Not enough points")
            }
           
        }
        
    }
    function RegisterHit(){
        backgroundMusic.play();
        if(enemy.className == 'HitAnimation'){
            enemy.className= 'HitAnimationAlt'
        }
        else{
            enemy.className= 'HitAnimation';
        }
        UpdateScore(1)
        console.log("Hit");
        
    }
    function UpdateScore(points){
        score+= points
        scoreElement.innerHTML = "Score: "+ score;

    }
</script>